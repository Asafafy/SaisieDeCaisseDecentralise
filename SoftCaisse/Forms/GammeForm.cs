using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows.Controls;
using System.Windows.Forms;
using ComponentFactory.Krypton.Toolkit;
using SoftCaisse.Models;

namespace SoftCaisse.Forms
{
    public partial class GammeForm : KryptonForm
    {
        // =============================================================================================================================================================================================
        // ============================================================================= DEBUT DECLARATION DES VARIABLES ===============================================================================
        // =============================================================================================================================================================================================
        private readonly AppDbContext _context;
        // =============================================================================================================================================================================================
        // =============================================================================== FIN DECLARATION DES VARIABLES ===============================================================================
        // =============================================================================================================================================================================================





        // =========================================================================================================================================================================================
        // ================================================================================== DEBUT CONSTRUCTEUR ===================================================================================
        // =========================================================================================================================================================================================
        public GammeForm()
        {
            InitializeComponent();

            _context = new AppDbContext();

            listBox1.Items.Clear();
            List<P_GAMME> P_GAMMEs = _context.P_GAMME.Where(g => g.G_Intitule != "" && g.G_Type == 0).ToList();
            listBox1.DataSource = P_GAMMEs.Select(g => g.G_Intitule).ToList();
        }
        // =========================================================================================================================================================================================
        // ==================================================================================== FIN CONSTRUCTEUR ===================================================================================
        // =========================================================================================================================================================================================





        // =========================================================================================================================================================================================
        // ==================================================================================== DEBUT EVENEMENTS ===================================================================================
        // =========================================================================================================================================================================================
        private void listBox1_SelectedIndexChanged(object sender, EventArgs e)
        {
            if (listBox1.SelectedItem != null)
            {
                short? numGamme = _context.P_GAMME.Where(elt => elt.G_Intitule == listBox1.SelectedItem.ToString()).FirstOrDefault().cbIndice;
                List<F_ENUMGAMME> f_ENUMGAMMEs = _context.F_ENUMGAMME.Where(variante => variante.EG_Champ == numGamme).ToList();
                listBox2.DataSource = null;
                listBox2.DataSource = f_ENUMGAMMEs.Select(eg => eg.EG_Enumere).ToList();
            }
        }
        // =========================================================================================================================================================================================
        // ===================================================================================== FIN EVENEMENTS ====================================================================================
        // =========================================================================================================================================================================================




    }
}

using SoftCaisse.Models;
using System.Collections.Generic;
using System.Data.SqlClient;
using System.Linq;

namespace SoftCaisse.Repositories
{
    internal class F_FAMILLERepository
    {
        // ==================================================================================
        // DEBUT DECLARATION DES VARIABLES ==================================================
        // ==================================================================================
        private readonly AppDbContext _context;
        // ==================================================================================
        // FIN DECLARATION DES VARIABLES ====================================================
        // ==================================================================================





        // ==================================================================================
        // DEBUT CONSTRUCTEUR ===============================================================
        // ==================================================================================
        public F_FAMILLERepository(AppDbContext context)
        {
            _context = context;
        }
        // ==================================================================================
        // FIN CONSTRUCTEUR =================================================================
        // ==================================================================================











        // ==================================================================================
        // DEBUT GET ========================================================================
        // ==================================================================================
        public List<F_FAMILLE> GetAll_F_FAMILLE_CL_No1_Zero()
        {
            using (AppDbContext context = new AppDbContext())
            {
                return context.F_FAMILLE.Where(f => f.CL_No1 != 0).ToList();
            }
        }


        // ==================================================================================
        // DEBUT GET ========================================================================
        // ==================================================================================










        // ==================================================================================
        // DEBUT CREATE =====================================================================
        // ==================================================================================

        // ==================================================================================
        // FIN CREATE =======================================================================
        // ==================================================================================









        // =================================================================================
        // DEBUT UPDATE ====================================================================
        // =================================================================================

        // =================================================================================
        // FIN UPDATE ======================================================================
        // =================================================================================









        // =================================================================================
        // DEBUT DELETE ====================================================================
        // =================================================================================
        public void DeleteByDoPiece(string doPiece)
        {
            string queryDeleteAvecCommande = @"
                DISABLE TRIGGER TG_CBDEL_F_FAMILLE ON F_FAMILLE;
                DISABLE TRIGGER TG_DEL_F_FAMILLE ON F_FAMILLE;

                DELETE FROM [dbo].[F_FAMILLE] WHERE DO_Piece = @DO_Piece;

                DISABLE TRIGGER TG_CBDEL_F_FAMILLE ON F_FAMILLE;
                DISABLE TRIGGER TG_DEL_F_FAMILLE ON F_FAMILLE;
            ";


            using(var context = new AppDbContext())
            {
                context.Database.ExecuteSqlCommand(
                    queryDeleteAvecCommande,
                    new SqlParameter("@DO_Piece", doPiece)
                );
            }
        }
        // =================================================================================
        // FIN DELETE ======================================================================
        // =================================================================================
    }
}
